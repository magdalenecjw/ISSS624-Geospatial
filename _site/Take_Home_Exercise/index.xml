<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Geospatial Analytics</title>
<link>https://geospatial2023.netlify.app/Take_Home_Exercise/index.html</link>
<atom:link href="https://geospatial2023.netlify.app/Take_Home_Exercise/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<image>
<url>https://geospatial2023.netlify.app/Images/logo.png</url>
<title>Geospatial Analytics</title>
<link>https://geospatial2023.netlify.app/Take_Home_Exercise/index.html</link>
</image>
<generator>quarto-1.3.433</generator>
<lastBuildDate>Fri, 24 Nov 2023 16:00:00 GMT</lastBuildDate>
<item>
  <title>1: Geospatial Analytics for Public Good</title>
  <dc:creator>Magdalene Chan</dc:creator>
  <link>https://geospatial2023.netlify.app/Take_Home_Exercise/Ex1/Take_home_Ex1.html</link>
  <description><![CDATA[ 



<section id="objectives" class="level1">
<h1>Objectives</h1>
<p>As city-wide urban infrastructures become increasingly digital, datasets from technologies like GPS and RFID on vehicles offer opportunities to track movement patterns over space and time. For instance, smart cards and GPS devices on public buses collect routes and ridership data, containing valuable structure and patterns for understanding human movement and behavior within cities. Despite their potential, the practical use of these extensive location-aware datasets often remains limited to basic tracking and mapping within GIS applications due to the lack of comprehensive spatial and spatio-temporal analysis functions in conventional GIS tools.</p>
<p>Exploratory Spatial Data Analysis (ESDA) holds tremendous potential to address such complex problems. In this study, appropriate Local Indicators of Spatial Association (GLISA) and Emerging Hot Spot Analysis (EHSA) will be applied to undercover the spatial and spatio-temporal mobility patterns of public bus passengers in Singapore.</p>
</section>
<section id="tasks" class="level1">
<h1>Tasks</h1>
<p>The following tasks will be undertaken in this exercise:</p>
<section id="geovisualisation-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="geovisualisation-and-analysis">Geovisualisation and Analysis</h2>
<ol type="1">
<li>Compute the passenger trips generated by origin at a hexagon level of 250m for the following time periods:
<ol type="1">
<li>Weekday morning peak – 6am to 9am (inclusive)</li>
<li>Weekday evening peak – 5pm to 8pm (inclusive)</li>
<li>Weekend/holiday morning peak – 11am to 2pm (inclusive)</li>
<li>Weekend/holiday evening peak – 4pm to 7pm (inclusive)</li>
</ol></li>
<li>Display the geographical distribution of the passenger trips using appropriate geovisualisation methods.</li>
<li>Describe the spatial patterns revealed by the geovisualisation (not more than 200 words per visual).</li>
</ol>
</section>
<section id="local-indicators-of-spatial-association-lisa-analysis" class="level2">
<h2 class="anchored" data-anchor-id="local-indicators-of-spatial-association-lisa-analysis">Local Indicators of Spatial Association (LISA) Analysis</h2>
<ol type="1">
<li>Compute LISA of the passengers trips generate by origin at hexagon level.</li>
<li>Display the LISA maps of the passengers trips generate by origin at hexagon level. The maps should only display the significant (i.e.&nbsp;p-value &lt; 0.05).</li>
<li>With reference to the analysis results, draw statistical conclusions (not more than 200 words per visual).</li>
</ol>
</section>
</section>
<section id="getting-started" class="level1">
<h1>Getting Started</h1>
<p>The code chunk below uses <code>p_load()</code> of <code>pacman</code> package to check if the required packages have been installed on the computer. If they are, the packages will be launched.</p>
<ul>
<li><code>sf</code> package is used for importing, managing, and processing geospatial data.</li>
<li><code>tmap</code> package is used for thematic mapping.</li>
<li><code>sfdep</code> package is used to create spatial weights matrix and LISA objects using the sf class to represent spatial data.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(sf, sfdep, tmap, tidyverse, knitr)</span></code></pre></div>
</details>
</div>
<p>The data sets used are:</p>
<ul>
<li>Bus Stop Location (Last updated Jul 2023) from <a href="https://datamall.lta.gov.sg/content/datamall/en/static-data.html">LTADataMall</a> retrieved on 18 Nov 2023</li>
<li>Passenger Volume by Origin Destination Bus Stops for Aug-Oct 2023 from <a href="https://datamall.lta.gov.sg/content/datamall/en/dynamic-data.html">LTADataMall</a> retrieved on 18 Nov 2023</li>
</ul>
</section>
<section id="import-data" class="level1">
<h1>Import Data</h1>
<section id="import-geospatial-data-bus-stop-locations" class="level2">
<h2 class="anchored" data-anchor-id="import-geospatial-data-bus-stop-locations">Import Geospatial Data: Bus Stop Locations</h2>
<p>The code chunk below uses the <code>st_read()</code> function of <strong>sf</strong> package to import <code>BusStop</code> shapefile into R as a simple feature data frame called <code>BusStop</code>. As <code>BusStop</code> uses <strong>svy21</strong> projected coordinate system, the <code>crs</code> is set to 3414.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">BusStop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_read</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dsn =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/geospatial"</span>, </span>
<span id="cb2-2">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">layer =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BusStop"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3414</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `C:\magdalenecjw\ISSS624 Geospatial\Take_Home_Exercise\Ex1\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5161 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
</section>
<section id="import-passenger-volume-by-origin-destination-bus-stops" class="level2">
<h2 class="anchored" data-anchor-id="import-passenger-volume-by-origin-destination-bus-stops">Import Passenger Volume by Origin-Destination Bus Stops</h2>
<p>The code chunk below uses the <code>read_csv()</code> function of <code>readr</code> package (imported with the <code>tidyverse</code> package) to import the csv files into R. A list called <code>list_of_data</code> is created and each CSV file is imported into a separate data frame within this list. The names of the data frames are generated dynamically based on the file names i.e.&nbsp;by extracting the month-year part of the csv file name. Finally, to access the data frames within the <code>list_of_data</code> without explicitly assigning them to new variables, the <code>list2env()</code> function in R is used.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a list to store the data frames</span></span>
<span id="cb4-2">file_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"origin_destination_bus_202308.csv"</span>, </span>
<span id="cb4-3">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"origin_destination_bus_202309.csv"</span>, </span>
<span id="cb4-4">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"origin_destination_bus_202310.csv"</span>)</span>
<span id="cb4-5">list_of_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load CSV files into R environment</span></span>
<span id="cb4-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(file_names)) {</span>
<span id="cb4-9">  file_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_names[i]</span>
<span id="cb4-10">  df_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"odbus_"</span>, </span>
<span id="cb4-11">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(file_name, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(file_name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, </span>
<span id="cb4-12">                           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(file_name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb4-13">  list_of_data[[df_name]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/aspatial/"</span>, file_name))</span>
<span id="cb4-14">}</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert list elements to separate data frames in the global environment</span></span>
<span id="cb4-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list2env</span>(list_of_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">envir =</span> .GlobalEnv)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;environment: R_GlobalEnv&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove the `list_of_data` data frame</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(list_of_data)</span></code></pre></div>
</details>
</div>
<p>Examine the structure of the data frames using the code chunks below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">August 2023 data</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">September 2023 data</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">October 2023 data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202308)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5709512 obs. of  7 variables:
 $ YEAR_MONTH         : chr  "2023-08" "2023-08" "2023-08" "2023-08" ...
 $ DAY_TYPE           : chr  "WEEKDAY" "WEEKENDS/HOLIDAY" "WEEKENDS/HOLIDAY" "WEEKDAY" ...
 $ TIME_PER_HOUR      : int  16 16 14 14 17 17 17 17 7 17 ...
 $ PT_TYPE            : chr  "BUS" "BUS" "BUS" "BUS" ...
 $ ORIGIN_PT_CODE     : int  4168 4168 80119 80119 44069 44069 20281 20281 19051 11169 ...
 $ DESTINATION_PT_CODE: int  10051 10051 90079 90079 17229 17229 20141 20141 10017 4219 ...
 $ TOTAL_TRIPS        : int  7 2 3 10 5 4 3 22 3 3 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202309)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5714196 obs. of  7 variables:
 $ YEAR_MONTH         : chr  "2023-09" "2023-09" "2023-09" "2023-09" ...
 $ DAY_TYPE           : chr  "WEEKENDS/HOLIDAY" "WEEKENDS/HOLIDAY" "WEEKDAY" "WEEKDAY" ...
 $ TIME_PER_HOUR      : int  17 10 10 7 7 11 16 16 16 20 ...
 $ PT_TYPE            : chr  "BUS" "BUS" "BUS" "BUS" ...
 $ ORIGIN_PT_CODE     : int  24499 65239 65239 23519 23519 52509 3151 54349 54349 43371 ...
 $ DESTINATION_PT_CODE: int  22221 65159 65159 23311 23311 42041 11161 53241 53241 14139 ...
 $ TOTAL_TRIPS        : int  1 9 2 6 1 2 18 3 2 1 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202310)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5694297 obs. of  7 variables:
 $ YEAR_MONTH         : chr  "2023-10" "2023-10" "2023-10" "2023-10" ...
 $ DAY_TYPE           : chr  "WEEKENDS/HOLIDAY" "WEEKDAY" "WEEKENDS/HOLIDAY" "WEEKDAY" ...
 $ TIME_PER_HOUR      : int  16 16 14 14 17 17 17 7 14 14 ...
 $ PT_TYPE            : chr  "BUS" "BUS" "BUS" "BUS" ...
 $ ORIGIN_PT_CODE     : int  4168 4168 80119 80119 44069 20281 20281 19051 81049 81049 ...
 $ DESTINATION_PT_CODE: int  10051 10051 90079 90079 17229 20141 20141 10017 70161 70161 ...
 $ TOTAL_TRIPS        : int  3 5 3 5 4 1 24 2 1 7 ...</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Based on the data frame structures seen above, <code>ORIGIN_PT_CODE</code> and <code>DESTINATION_PT_CODE</code> are listed as integer variables, though they are categorical in nature. As such, they should be transformed to factors so that R treats them as a grouping variable. Additionally, the length of the integer variables are a mixture of 4 and 5 numeric characters. However, bus stops in Singapore are identifiable via a 5-digit bus stop code. As such, we will need to standardise the variable length.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">August 2023 data</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">September 2023 data</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" aria-controls="tabset-2-3" aria-selected="false">October 2023 data</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Columns to convert to factors</span></span>
<span id="cb13-2">columns_to_convert <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DESTINATION_PT_CODE"</span>)</span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure length of 5 characters for specific columns</span></span>
<span id="cb13-5">odbus_202308[columns_to_convert] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(odbus_202308[columns_to_convert], <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%05d"</span>, x)</span>
<span id="cb13-7">})</span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply as.factor() to the adjusted columns</span></span>
<span id="cb13-10">odbus_202308[columns_to_convert] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(odbus_202308[columns_to_convert], as.factor)</span>
<span id="cb13-11"></span>
<span id="cb13-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Re-examine the structure of the data frame</span></span>
<span id="cb13-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202308)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5709512 obs. of  7 variables:
 $ YEAR_MONTH         : chr  "2023-08" "2023-08" "2023-08" "2023-08" ...
 $ DAY_TYPE           : chr  "WEEKDAY" "WEEKENDS/HOLIDAY" "WEEKENDS/HOLIDAY" "WEEKDAY" ...
 $ TIME_PER_HOUR      : int  16 16 14 14 17 17 17 17 7 17 ...
 $ PT_TYPE            : chr  "BUS" "BUS" "BUS" "BUS" ...
 $ ORIGIN_PT_CODE     : Factor w/ 5067 levels "01012","01013",..: 104 104 4422 4422 2008 2008 832 832 779 355 ...
 $ DESTINATION_PT_CODE: Factor w/ 5071 levels "01012","01013",..: 239 239 4736 4736 691 691 807 807 234 107 ...
 $ TOTAL_TRIPS        : int  7 2 3 10 5 4 3 22 3 3 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure length of 5 characters for specific columns</span></span>
<span id="cb15-2">odbus_202309[columns_to_convert] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(odbus_202309[columns_to_convert], <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%05d"</span>, x)</span>
<span id="cb15-4">})</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply as.factor() to the adjusted columns</span></span>
<span id="cb15-7">odbus_202309[columns_to_convert] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(odbus_202309[columns_to_convert], as.factor)</span>
<span id="cb15-8"></span>
<span id="cb15-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Re-examine the structure of the data frame</span></span>
<span id="cb15-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202309)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5714196 obs. of  7 variables:
 $ YEAR_MONTH         : chr  "2023-09" "2023-09" "2023-09" "2023-09" ...
 $ DAY_TYPE           : chr  "WEEKENDS/HOLIDAY" "WEEKENDS/HOLIDAY" "WEEKDAY" "WEEKDAY" ...
 $ TIME_PER_HOUR      : int  17 10 10 7 7 11 16 16 16 20 ...
 $ PT_TYPE            : chr  "BUS" "BUS" "BUS" "BUS" ...
 $ ORIGIN_PT_CODE     : Factor w/ 5067 levels "01012","01013",..: 1201 3608 3608 1154 1154 2726 67 2866 2866 1906 ...
 $ DESTINATION_PT_CODE: Factor w/ 5072 levels "01012","01013",..: 1008 3598 3598 1125 1125 1793 354 2777 2777 515 ...
 $ TOTAL_TRIPS        : int  1 9 2 6 1 2 18 3 2 1 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure length of 5 characters for specific columns</span></span>
<span id="cb17-2">odbus_202310[columns_to_convert] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(odbus_202310[columns_to_convert], <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%05d"</span>, x)</span>
<span id="cb17-4">})</span>
<span id="cb17-5"></span>
<span id="cb17-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply as.factor() to the adjusted columns</span></span>
<span id="cb17-7">odbus_202310[columns_to_convert] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(odbus_202310[columns_to_convert], as.factor)</span>
<span id="cb17-8"></span>
<span id="cb17-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Re-examine the structure of the data frame</span></span>
<span id="cb17-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202310)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5694297 obs. of  7 variables:
 $ YEAR_MONTH         : chr  "2023-10" "2023-10" "2023-10" "2023-10" ...
 $ DAY_TYPE           : chr  "WEEKENDS/HOLIDAY" "WEEKDAY" "WEEKENDS/HOLIDAY" "WEEKDAY" ...
 $ TIME_PER_HOUR      : int  16 16 14 14 17 17 17 7 14 14 ...
 $ PT_TYPE            : chr  "BUS" "BUS" "BUS" "BUS" ...
 $ ORIGIN_PT_CODE     : Factor w/ 5073 levels "01012","01013",..: 105 105 4428 4428 2011 834 834 781 4462 4462 ...
 $ DESTINATION_PT_CODE: Factor w/ 5077 levels "01012","01013",..: 240 240 4742 4742 693 809 809 235 4002 4002 ...
 $ TOTAL_TRIPS        : int  3 5 3 5 4 1 24 2 1 7 ...</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="extract-commuting-flow-data" class="level2">
<h2 class="anchored" data-anchor-id="extract-commuting-flow-data">Extract Commuting Flow data</h2>
<p>The code chunk below creates a function to extract commuting flows for the 4 target time periods. After extracting the commuting flow, the function will check for missing Bus Stops against the <code>BusStop</code> data set, and impute a value of <code>0</code> if so.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a function that takes in two inputs to extract commuting flow</span></span>
<span id="cb19-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data -- Input odbus data</span></span>
<span id="cb19-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BusStopList -- Input full list of bus stops for checking</span></span>
<span id="cb19-4">commuting_flow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(data, BusStopList) {</span>
<span id="cb19-5">  </span>
<span id="cb19-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract commuting flow for weekday morning peak</span></span>
<span id="cb19-7">  weekday_morn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(DAY_TYPE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WEEKDAY"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ORIGIN_PT_CODE) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(TOTAL_TRIPS)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekday morning"</span>)</span>
<span id="cb19-13">  </span>
<span id="cb19-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify missing Bus Stops and impute a 0 value</span></span>
<span id="cb19-15">  weekday_morn_missing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BusStopList <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(weekday_morn, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekday morning"</span>)</span>
<span id="cb19-19">  </span>
<span id="cb19-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract commuting flow for weekday evening peak</span></span>
<span id="cb19-21">  weekday_evening <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(DAY_TYPE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WEEKDAY"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ORIGIN_PT_CODE) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(TOTAL_TRIPS))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekday evening"</span>)</span>
<span id="cb19-27">  </span>
<span id="cb19-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify missing Bus Stops and impute a 0 value</span></span>
<span id="cb19-29">  weekday_evening_missing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BusStopList <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(weekday_evening, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekday evening"</span>)</span>
<span id="cb19-33">  </span>
<span id="cb19-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract commuting flow for weekend morning peak</span></span>
<span id="cb19-35">  weekend_morn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(DAY_TYPE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WEEKENDS/HOLIDAY"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ORIGIN_PT_CODE) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(TOTAL_TRIPS))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-40">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekend morning"</span>)</span>
<span id="cb19-41">  </span>
<span id="cb19-42">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify missing Bus Stops and impute a 0 value</span></span>
<span id="cb19-43">  weekend_morn_missing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BusStopList <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(weekend_morn, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-45">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekend morning"</span>)</span>
<span id="cb19-47">  </span>
<span id="cb19-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract commuting flow for weekend evening peak</span></span>
<span id="cb19-49">  weekend_evening <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(DAY_TYPE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WEEKENDS/HOLIDAY"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-51">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> TIME_PER_HOUR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ORIGIN_PT_CODE) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(TOTAL_TRIPS))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-54">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekend evening"</span>)</span>
<span id="cb19-55">  </span>
<span id="cb19-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify missing Bus Stops and impute a 0 value</span></span>
<span id="cb19-57">  weekend_evening_missing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> BusStopList <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-58">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(weekend_evening, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-59">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-60">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SOURCE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weekend evening"</span>)</span>
<span id="cb19-61">  </span>
<span id="cb19-62">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine the data frames</span></span>
<span id="cb19-63">  result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(weekday_morn, weekday_morn_missing, </span>
<span id="cb19-64">                  weekday_evening, weekday_evening_missing, </span>
<span id="cb19-65">                  weekend_morn, weekend_morn_missing,</span>
<span id="cb19-66">                  weekend_evening, weekend_evening_missing)</span>
<span id="cb19-67">  </span>
<span id="cb19-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(result)</span>
<span id="cb19-69">}</span></code></pre></div>
</details>
</div>
<p>The function can then be applied to each month’s <code>odbus</code> data frame to extract commuting flows for the 4 target time periods within each month.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">August 2023 data</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false">September 2023 data</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" aria-controls="tabset-3-3" aria-selected="false">October 2023 data</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a list of full Bus Stop codes for checking</span></span>
<span id="cb20-2">BusStopList <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ORIGIN_PT_CODE =</span> BusStop<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>BUS_STOP_N)</span>
<span id="cb20-3"></span>
<span id="cb20-4">odbus_202308_commuterflow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">commuting_flow</span>(odbus_202308, BusStopList)</span></code></pre></div>
</details>
</div>
<p>The code chunk below will be used to check that all bus stops have four rows of data (i.e.&nbsp;weekday morning, weekday evening, weekend morning and weekend evening). If there are any bus stops with less than four rows of data, the Bus Stop codes will be printed and checked against the list of full Bus Stop codes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">odbus_202308_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202308_commuterflow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(ORIGIN_PT_CODE) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) </span>
<span id="cb21-4"></span>
<span id="cb21-5">result_202308 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202308_commuterflow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Message =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(ORIGIN_PT_CODE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> BusStopList<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ORIGIN_PT_CODE, </span>
<span id="cb21-7">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cannot be found"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Message <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cannot be found"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(ORIGIN_PT_CODE, Message) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb21-11"></span>
<span id="cb21-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_202308)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 2
   ORIGIN_PT_CODE Message        
   &lt;fct&gt;          &lt;chr&gt;          
 1 03361          cannot be found
 2 03549          cannot be found
 3 03579          cannot be found
 4 04331          cannot be found
 5 14529          cannot be found
 6 14539          cannot be found
 7 18111          cannot be found
 8 41161          cannot be found
 9 44099          cannot be found
10 44931          cannot be found
# … with 44 more rows</code></pre>
</div>
</div>
<p>A search online shows that some of these can be clearly identified as new bus stops. Given that our geospatial data for bus stop locations is last updated in July 2023 while our aspatial passenger volume data is from August to October 2023, this could be a possible explanation for why some of the bus stops cannot be found in the geospatial data.</p>
<p>Given that these bus stops cannot be located within the geospatial data, we will drop these Bus Stops from our analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">odbus_202308_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202308_commuterflow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(odbus_202308_check, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>)</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202308_final)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [20,760 × 3] (S3: tbl_df/tbl/data.frame)
 $ ORIGIN_PT_CODE: Factor w/ 5199 levels "01012","01013",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ TRIPS         : num [1:20760] 1973 952 1789 2561 2938 ...
 $ SOURCE        : chr [1:20760] "weekday morning" "weekday morning" "weekday morning" "weekday morning" ...</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">odbus_202309_commuterflow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">commuting_flow</span>(odbus_202309, BusStopList)</span></code></pre></div>
</details>
</div>
<p>The code chunk below will be used to check that all bus stops have four rows of data (i.e.&nbsp;weekday morning, weekday evening, weekend morning and weekend evening). If there are any bus stops with less than four rows of data, the Bus Stop codes will be printed and checked against the list of full Bus Stop codes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">odbus_202309_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202309_commuterflow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(ORIGIN_PT_CODE) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) </span>
<span id="cb26-4"></span>
<span id="cb26-5">result_202309 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202309_check <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Message =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(ORIGIN_PT_CODE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> BusStopList<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ORIGIN_PT_CODE, </span>
<span id="cb26-7">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cannot be found"</span>))</span>
<span id="cb26-8"></span>
<span id="cb26-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_202309)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  ORIGIN_PT_CODE     n Message        
  &lt;fct&gt;          &lt;int&gt; &lt;chr&gt;          
1 03549              2 cannot be found
2 14521              3 cannot be found
3 68181              2 cannot be found
4 68189              2 cannot be found
5 68191              1 cannot be found
6 68199              1 cannot be found
7 96461              3 cannot be found
8 96471              3 cannot be found
9 96479              3 cannot be found</code></pre>
</div>
</div>
<p>Given that these bus stops cannot be located within the geospatial data, we will drop these Bus Stops from our analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">odbus_202309_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202309_commuterflow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(odbus_202309_check, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>)</span>
<span id="cb28-3"></span>
<span id="cb28-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202309_final)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [20,760 × 3] (S3: tbl_df/tbl/data.frame)
 $ ORIGIN_PT_CODE: Factor w/ 5199 levels "01012","01013",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ TRIPS         : num [1:20760] 1640 764 1322 2373 2562 ...
 $ SOURCE        : chr [1:20760] "weekday morning" "weekday morning" "weekday morning" "weekday morning" ...</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1">odbus_202310_commuterflow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">commuting_flow</span>(odbus_202310, BusStopList)</span></code></pre></div>
</details>
</div>
<p>The code chunk below will be used to check that all bus stops have four rows of data (i.e.&nbsp;weekday morning, weekday evening, weekend morning and weekend evening). If there are any bus stops with less than four rows of data, the Bus Stop codes will be printed and checked against the list of full Bus Stop codes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">odbus_202310_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202310_commuterflow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(ORIGIN_PT_CODE) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) </span>
<span id="cb31-4"></span>
<span id="cb31-5">result_202310 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202310_check <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Message =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(ORIGIN_PT_CODE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> BusStopList<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ORIGIN_PT_CODE, </span>
<span id="cb31-7">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cannot be found"</span>))</span>
<span id="cb31-8"></span>
<span id="cb31-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(result_202310)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   ORIGIN_PT_CODE     n Message        
   &lt;fct&gt;          &lt;int&gt; &lt;chr&gt;          
 1 03549              3 cannot be found
 2 14521              3 cannot be found
 3 44711              2 cannot be found
 4 68181              2 cannot be found
 5 68189              2 cannot be found
 6 68191              2 cannot be found
 7 68199              2 cannot be found
 8 96461              3 cannot be found
 9 96471              3 cannot be found
10 96479              3 cannot be found</code></pre>
</div>
</div>
<p>Given that these bus stops cannot be located within the geospatial data, we will drop these Bus Stops from our analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">odbus_202310_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> odbus_202310_commuterflow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb33-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(odbus_202310_check, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>)</span>
<span id="cb33-3"></span>
<span id="cb33-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(odbus_202310_final)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [20,780 × 3] (S3: tbl_df/tbl/data.frame)
 $ ORIGIN_PT_CODE: Factor w/ 5205 levels "01012","01013",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ TRIPS         : num [1:20780] 1770 841 1530 2483 2919 ...
 $ SOURCE        : chr [1:20780] "weekday morning" "weekday morning" "weekday morning" "weekday morning" ...</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="append-commuting-flow-data-with-bus-stop-locations" class="level2">
<h2 class="anchored" data-anchor-id="append-commuting-flow-data-with-bus-stop-locations">Append Commuting Flow data with Bus Stop Locations</h2>
<p><code>left_join()</code> of <strong>dplyr</strong> is used to join the geographical data and commuting flow data table using County as the common identifier. Left join is done to ensure that the geospatial properties (geometry column) of the <code>BusStop</code> sf data frame is retained. After the join, a pipe operation is done to convert NA values into 0 – this ensures that the entire geographical area of Singapore can be seen on the resultant map output.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">origin_BusStop_202308 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(BusStop, odbus_202308_commuterflow,</span>
<span id="cb35-2">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BUS_STOP_N"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ORIGIN_PT_CODE"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TRIPS</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>))</span></code></pre></div>
</details>
</div>
<p>Check for any duplicates using the code chunk below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1">duplicate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> origin_BusStop_202308 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by_all</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb36-5"></span>
<span id="cb36-6">duplicate</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 5 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
# A tibble: 0 × 6
# … with 6 variables: BUS_STOP_N &lt;chr&gt;, BUS_ROOF_N &lt;chr&gt;, LOC_DESC &lt;chr&gt;,
#   TRIPS &lt;dbl&gt;, SOURCE &lt;chr&gt;, geometry &lt;GEOMETRY [m]&gt;</code></pre>
</div>
</div>
<p><code>cellsize</code> argument is the cell size, in the units that the crs of the spatial data is using. Since the data is set in SVY21 projected coordinate system, which <a href="https://epsg.io/3414">uses metres as the unit</a>, the value is set as <code>c(250,250)</code> to create a hexagon layer of 250m.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">area_honeycomb_grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_make_grid</span>(origin_BusStop_202308, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">what =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb38-2"></span>
<span id="cb38-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To sf and add grid ID</span></span>
<span id="cb38-4">honeycomb_grid_sf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sf</span>(area_honeycomb_grid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb38-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add grid ID</span></span>
<span id="cb38-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grid_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lengths</span>(area_honeycomb_grid)))</span>
<span id="cb38-7"></span>
<span id="cb38-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># count number of points in each grid</span></span>
<span id="cb38-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://gis.stackexchange.com/questions/323698/counting-points-in-polygons-with-sf-package-of-r</span></span>
<span id="cb38-10">honeycomb_grid_sf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>TOT_TRIPS <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lengths</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(honeycomb_grid_sf, origin_BusStop_202308))</span>
<span id="cb38-11"></span>
<span id="cb38-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove grid without value of 0 (i.e. no points in side that grid)</span></span>
<span id="cb38-13">honeycomb_count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(honeycomb_grid_sf, TOT_TRIPS <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tmap_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>)</span>
<span id="cb39-2">map_honeycomb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_shape</span>(honeycomb_count) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_fill</span>(</span>
<span id="cb39-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TOT_TRIPS"</span>,</span>
<span id="cb39-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>,</span>
<span id="cb39-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cont"</span>,</span>
<span id="cb39-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of trips"</span>,</span>
<span id="cb39-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grid_id"</span>,</span>
<span id="cb39-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showNA =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb39-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb39-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">popup.vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb39-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of trips: "</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TOT_TRIPS"</span></span>
<span id="cb39-13">    ),</span>
<span id="cb39-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">popup.format =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb39-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TOT_TRIPS =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"f"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb39-16">    )</span>
<span id="cb39-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_borders</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb39-19">map_honeycomb</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://geospatial2023.netlify.app/Take_Home_Exercise/Ex1/Take_home_Ex1_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="1152"></p>
</div>
</div>


</section>
</section>

 ]]></description>
  <guid>https://geospatial2023.netlify.app/Take_Home_Exercise/Ex1/Take_home_Ex1.html</guid>
  <pubDate>Fri, 24 Nov 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Take Home Exercise 2</title>
  <dc:creator>Magdalene Chan</dc:creator>
  <link>https://geospatial2023.netlify.app/Take_Home_Exercise/Ex2/Take_home_Ex2.html</link>
  <description><![CDATA[ 



<p>Placeholder</p>



 ]]></description>
  <guid>https://geospatial2023.netlify.app/Take_Home_Exercise/Ex2/Take_home_Ex2.html</guid>
  <pubDate>Fri, 01 Dec 2023 07:17:51 GMT</pubDate>
</item>
</channel>
</rss>
